"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1281],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=c(n),d=r,h=u["".concat(s,".").concat(d)]||u[d]||p[d]||o;return n?a.createElement(h,i(i({ref:t},m),{},{components:n})):a.createElement(h,i({ref:t},m))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6380:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={},i="OpenTelemetry with AWS Lambda",l={unversionedId:"opentelemetry/otel-and-aws-lambda",id:"opentelemetry/otel-and-aws-lambda",title:"OpenTelemetry with AWS Lambda",description:"At the time of writing, OpenTelemetry and AWS Lambda still seems to be a bumpy ride. In the past, a lot of the documentation about using and configuring Collectors bears no relevance to using this with AWS Lambda, as each lambda function has it's own collector instance.",source:"@site/docs/opentelemetry/otel-and-aws-lambda.md",sourceDirName:"opentelemetry",slug:"/opentelemetry/otel-and-aws-lambda",permalink:"/docs/opentelemetry/otel-and-aws-lambda",draft:!1,editUrl:"https://github.com/agarthetiger/docusaurus/tree/main/docs/opentelemetry/otel-and-aws-lambda.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"OpenTelemetry",permalink:"/docs/category/opentelemetry"},next:{title:"Podman",permalink:"/docs/category/podman"}},s={},c=[{value:"Resources",id:"resources",level:2}],m={toc:c};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"opentelemetry-with-aws-lambda"},"OpenTelemetry with AWS Lambda"),(0,r.kt)("p",null,"At the time of writing, OpenTelemetry and AWS Lambda still seems to be a bumpy ride. In the past, a lot of the documentation about using and configuring Collectors bears no relevance to using this with AWS Lambda, as each lambda function has it's own collector instance. "),(0,r.kt)("p",null,"For some time, the response time of a lmabda function had to include the time taken to send the telemetry before the response could be sent from the Lambda function back to the caller. The Decouple Processor fixed this but this seemed to be quite late to the game, as though this was an edge case being supported. Until even more recently, using the Decoupel processor also means using the OpenTelemetry Lambda layers as this was n't includes in the AWS Distribution for Open Telemetry (ADOT). "),(0,r.kt)("p",null,"As should always be the case, a lot of the power and value from OpenTelemetry comes from observing Traces which span multiple different backends. Somehow Typescript and ESM are also an edge case so instrumenting fetch is also ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/open-telemetry/opentelemetry-lambda/issues/1557#issuecomment-2466435496"},"not something covered by the auto-instrumentation"),"."),(0,r.kt)("h2",{id:"resources"},"Resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://aws-otel.github.io/"},"AWS Distribution for Open Telemetry (ADOT)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Note that also here you need to instrument undici if using fetch in the ",(0,r.kt)("a",{parentName:"li",href:"https://aws-otel.github.io/docs/getting-started/lambda/lambda-js"},"OTEL_NODE_ENABLED_INSTRUMENTATIONS"),"."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.otelbin.io/"},"OTel Bin")," - Validate your collector.yaml configuration against known distributions. I raised a request many months ago but surprisingly you still can't validate configuration against the official OpenTelemetry Lambda Layers."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://instrumentation-score.com/"},"Instrumentation Score"),' - A project to objectively "score" your instrumentation.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://dalejsalter.com/post/8afd46ad-7da2-4b2a-9cb5-9e5ae4fe6cc2/cdk-lambda-otel-honeycomb"},"Blog - Instrumenting a Typescript Lambda with Honeycomb")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.honeycomb.io/"},"Honeycomb")," - ",(0,r.kt)("a",{parentName:"li",href:"https://docs.honeycomb.io/integrations/aws/lambda/opentelemetry/"},"Export Data with AWS Lambda Layer + OpenTelemetry"))))}u.isMDXComponent=!0}}]);